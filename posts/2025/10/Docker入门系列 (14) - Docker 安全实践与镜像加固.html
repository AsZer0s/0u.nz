<!doctype html><html><head><meta charset="utf-8"><title>Docker入门系列 (14) - Docker 安全实践与镜像加固</title><style>:root{--bg:#111315;--fg:#d6d6d6;--muted:#8b8b8b;--link:#8fa3ad;--link-hover:#c0d2db;--border:#2a2d30;--code-bg:#1a1d1f;--code-border:#2d3135}body{max-width:640px;margin:48px auto;padding:0 16px;background:var(--bg);color:var(--fg);font-family:'Noto Sans SC',system-ui,-apple-system,BlinkMacSystemFont;line-height:1.7}h1{font-size:1.2rem;font-weight:500;margin-bottom:12px}h2{font-size:1.1rem;font-weight:500;margin:2rem 0 1rem;color:var(--fg)}h3{font-size:1rem;font-weight:500;margin:1.5rem 0 0.75rem}.site-header{display:flex;align-items:center;gap:12px;margin-bottom:8px}.site-logo{height:10px;width:auto;display:block}nav{margin-bottom:32px;font-size:0.9rem}nav a{color:var(--muted);text-decoration:none;margin-right:12px}nav a:hover{color:var(--fg)}ul{list-style:none;padding:0;margin:0}li{margin:0.8rem 0}li a{color:var(--link);font-size:0.95rem;text-decoration:none}li a:hover{color:var(--link-hover)}.post-date{color:var(--muted);font-size:0.9rem}p{margin:1em 0}code{background:var(--code-bg);border:1px solid var(--code-border);border-radius:4px;padding:2px 6px;font-family:'Consolas','Monaco','Courier New',monospace;font-size:0.9em;color:#e6e6e6}pre{background:var(--code-bg);border:1px solid var(--code-border);border-radius:6px;padding:16px;overflow-x:auto;margin:1.5em 0}pre::-webkit-scrollbar{height:6px}pre::-webkit-scrollbar-track{background:var(--code-bg)}pre::-webkit-scrollbar-thumb{background:var(--code-border);border-radius:3px}pre::-webkit-scrollbar-thumb:hover{background:var(--muted)}pre code{background:none;border:none;padding:0;font-size:0.875em;line-height:1.6}blockquote{border-left:3px solid var(--border);padding-left:1em;margin:1.5em 0;color:var(--muted);font-style:italic}a{color:var(--link);text-decoration:none}a:hover{color:var(--link-hover)}img{max-width:100%;height:auto;border-radius:4px;margin:1.5em 0}hr{border:none;border-top:1px solid var(--border);margin:2rem 0}table{width:100%;border-collapse:collapse;margin:1.5em 0}th,td{border:1px solid var(--border);padding:8px 12px;text-align:left}th{background:var(--code-bg);font-weight:500}article ul,article ol{list-style:initial;padding-left:2em;margin:1em 0}article li{margin:0.5em 0}footer{margin-top:3rem;padding-top:2rem;border-top:1px solid var(--border);text-align:center}.footer-logo{height:32px;width:auto;display:inline-block;opacity:0.6;transition:opacity 0.3s}.footer-logo:hover{opacity:1}</style><style> .post-meta{display:flex;align-items:center;gap:10px;font-size:13px;color:var(--muted);margin-bottom:24px;flex-wrap:wrap;}.post-tags{display:flex;gap:8px;flex-wrap:wrap;}.tag{font-size:12px;color:var(--muted);text-decoration:none;}.tag::before{content:"#";opacity:.4;}.tag:hover{color:var(--fg);} </style><script> MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']], processEscapes: true, processEnvironments: true }, options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'] } }; </script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet"></head><body><p><a href="/">← index</a></p><h1>Docker入门系列 (14) - Docker 安全实践与镜像加固</h1><div class="post-meta"><span>2025-10-04</span><div class="post-tags"><a class="tag" href="/tags/Linux">Linux</a><a class="tag" href="/tags/开发">开发</a><a class="tag" href="/tags/Docker">Docker</a></div></div><article><p>容器技术虽然提升了部署效率，但也带来了新的安全挑战</p><p>本章将介绍 Docker 的安全实践，包括镜像加固、权限控制、漏洞扫描与网络隔离，帮助你构建更安全的容器运行环境</p><hr /><h2>容器安全的核心问题</h2><table><thead><tr><th>问题</th><th>风险</th></tr></thead><tbody><tr><td>镜像来源不可信</td><td>恶意代码、后门</td></tr><tr><td>使用 root 用户运行</td><td>权限过高，易被攻击</td></tr><tr><td>镜像体积过大</td><td>增加攻击面与构建时间</td></tr><tr><td>网络暴露过多端口</td><td>易遭扫描与攻击</td></tr><tr><td>缺乏漏洞检测</td><td>隐藏安全隐患</td></tr></tbody></table><hr /><h2>镜像加固建议</h2><h3>使用可信镜像源</h3><ul><li>优先使用官方镜像或企业认证镜像</li><li>避免使用 <code>latest</code> 标签，锁定版本号</li></ul><pre><code class="language-bash">FROM nginx:1.25.2 </code></pre><h3>镜像瘦身</h3><ul><li>使用轻量基础镜像，如 <code>alpine</code></li></ul><pre><code class="language-dockerfile">FROM node:18-alpine </code></pre><ul><li>清理构建缓存与临时文件</li></ul><pre><code class="language-dockerfile">RUN apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/* </code></pre><hr /><h2>最小权限原则</h2><h3>避免使用 root 用户</h3><pre><code class="language-dockerfile">RUN addgroup -S appgroup &amp;&amp; adduser -S appuser -G appgroup USER appuser </code></pre><h3>限制容器能力</h3><pre><code class="language-bash">docker run --cap-drop=ALL --cap-add=NET_BIND_SERVICE ... </code></pre><h3>只读文件系统</h3><pre><code class="language-bash">docker run --read-only ... </code></pre><hr /><h2>网络隔离与访问控制</h2><ul><li>使用自定义网络，限制服务间通信</li><li>仅暴露必要端口，避免使用 <code>--network host</code></li><li>配置防火墙与安全组（如 iptables、cloud firewall）</li></ul><hr /><h2>镜像漏洞扫描工具</h2><table><thead><tr><th>工具</th><th>特点</th></tr></thead><tbody><tr><td>Trivy</td><td>开源、快速、支持本地与 CI</td></tr><tr><td>Clair</td><td>支持多种镜像仓库</td></tr><tr><td>Snyk</td><td>商业服务，支持依赖分析</td></tr><tr><td>Docker Scout</td><td>Docker 官方集成工具（Docker Desktop）</td></tr></tbody></table><p>使用 Trivy 示例：</p><pre><code class="language-bash">trivy image yourname/myapp </code></pre><hr /><h2>Registry 安全建议</h2><ul><li>使用 HTTPS 加密传输</li><li>配置访问认证与权限控制</li><li>定期清理过期镜像与标签</li><li>启用镜像签名与审计日志</li></ul><hr /><h2>容器运行时安全</h2><ul><li>使用 AppArmor / SELinux 加强隔离</li><li>使用 seccomp 限制系统调用</li><li>使用 rootless Docker 降低权限风险</li></ul><hr /><h2>总结</h2><p>安全不是附加项，而是容器部署的基础保障</p><p>通过镜像加固、权限控制、漏洞扫描与网络隔离，你可以构建一个更安全、更可靠的容器运行环境</p><p>下一章将作为本系列的收官篇，总结 Docker 项目实战经验与部署策略，帮助你从入门走向生产</p></article><hr><p><a href="/">← index</a></p><footer><img src="/0unz.png" alt="0u logo" class="footer-logo"></footer></body></html>